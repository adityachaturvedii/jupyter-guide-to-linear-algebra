
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Orthogonalization &#8212; Jupyter Guide to Linear Algebra</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Orthogonalization';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="QR Factorization" href="QR_Factorization.html" />
    <link rel="prev" title="Inner Products" href="Inner_Products.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/reflection_logo.png" class="logo__image only-light" alt="Jupyter Guide to Linear Algebra - Home"/>
    <script>document.write(`<img src="_static/reflection_logo.png" class="logo__image only-dark" alt="Jupyter Guide to Linear Algebra - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to the Jupyter Guide to Linear Algebra
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="Jupyter_Introduction.html">Introduction to Jupyter</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Python_Introduction.html">Introduction to Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="Numpy_Introduction.html">Introduction to NumPy and Matplotlib</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Linear_Systems.html">Linear Systems</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Gaussian_Elimination.html">Gaussian Elimination</a></li>
<li class="toctree-l2"><a class="reference internal" href="Matrix_Algebra.html">Matrix Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="Solving_Systems.html">Solving Systems using Elimination</a></li>
<li class="toctree-l2"><a class="reference internal" href="Inverse_Matrices.html">Inverse Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="LU_Factorization.html">LU Factorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="Applications.html">Applications of Linear Systems and Matrix Algebra</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Vector_Spaces.html">Vector Spaces</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="General_Linear_Systems.html">General Linear Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="Linear_Combinations.html">Linear Combinations</a></li>
<li class="toctree-l2"><a class="reference internal" href="Linear_Independence.html">Linear Independence</a></li>
<li class="toctree-l2"><a class="reference internal" href="Bases.html">Bases</a></li>
<li class="toctree-l2"><a class="reference internal" href="Vector_Space_Examples.html">Vector Space Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="Applications_VS.html">Applications of Vector Spaces</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Linear_Transformations.html">Linear Transformations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Matrix_Representations.html">Matrix Representations</a></li>
<li class="toctree-l2"><a class="reference internal" href="Planar_Transformations.html">Transformations in a Plane</a></li>
<li class="toctree-l2"><a class="reference internal" href="Applications_LT.html">Applications of Linear Transformations</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="Inner_Products.html">Inner Products</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Orthogonalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="QR_Factorization.html">QR Factorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="Orthogonal_Subspaces.html">Orthogonal Subspaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="Least_Squares_Solutions.html">Least Squares Solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Projections.html">Projections</a></li>
<li class="toctree-l2"><a class="reference internal" href="Applications_IP.html">Applications of Inner Products</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Eigenvalues.html">Eigenvalues</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Diagonalization.html">Diagonalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="Approximating_Eigenvalues.html">Approximating Eigenvalues</a></li>
<li class="toctree-l2"><a class="reference internal" href="Applications_EV.html">Applications of Eigenvalues and Eigenvectors</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Solutions.html">Solutions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Introduction_Solutions.html">Introduction to Jupyter</a></li>
<li class="toctree-l2"><a class="reference internal" href="Linear_Systems_Solutions.html">Linear Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="Vector_Spaces_Solutions.html">Vector Spaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="Linear_Transformations_Solutions.html">Linear Transformations</a></li>
<li class="toctree-l2"><a class="reference internal" href="Inner_Products_Solutions.html">Inner Products</a></li>
<li class="toctree-l2"><a class="reference internal" href="Eigenvalues_Solutions.html">Eigenvalues</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Orthogonalization.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Orthogonalization</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#projecting-vectors-onto-vectors">Projecting vectors onto vectors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gram-schmidt-algorithm">Gram-Schmidt algorithm</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-applying-the-gram-schmidt-algorithm">Example 1:  Applying the Gram-Schmidt algorithm</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#orthogonal-matrices">Orthogonal matrices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="orthogonalization">
<h1>Orthogonalization<a class="headerlink" href="#orthogonalization" title="Link to this heading">#</a></h1>
<p>Some of the most important applications of inner products involve finding and using sets of vectors that are mutually orthogonal.  A set of nonzero vectors <span class="math notranslate nohighlight">\(\{U_1, U_2, U_3 ... U_n\}\)</span> is <strong>mutually orthogonal</strong> if <span class="math notranslate nohighlight">\(U_i\cdot U_j = 0\)</span> whenever <span class="math notranslate nohighlight">\(i \neq j\)</span>.  This simply means that every vector in the set is orthogonal to every other vector in the set.  If a set of vectors is mutually orthogonal <em>and</em> every vector in the set is a <em>unit vector</em>, we say the set is <strong>orthonormal</strong>.  In other words, every vector in an orthonormal set has magnitude one, and is orthogonal to every other vector in the set.</p>
<p>Orthonormal sets must be linearly independent, so it makes sense to think of them as a basis for some vector subspace.  Any collection of vectors from the standard bases of <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span> are orthonormal sets.  For example, the set of vectors <span class="math notranslate nohighlight">\(\{E_1, E_4, E_5\}\)</span> from the standard basis of <span class="math notranslate nohighlight">\(\mathbb{R}^5\)</span> forms a orthonormal basis for a subspace of <span class="math notranslate nohighlight">\(\mathbb{R}^5\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
E_1 = \left[ \begin{array}{r} 1\\0\\0\\0\\0 \end{array}\right] \hspace{0.7cm} 
E_4 = \left[ \begin{array}{r} 0\\0\\0\\1\\0 \end{array}\right] \hspace{0.7cm}
E_5 = \left[ \begin{array}{r} 0\\0\\0\\0\\1 \end{array}\right] \hspace{0.7cm}
\end{equation}
\end{split}\]</div>
<p>In this section we will focus on a process called orthogonalization.  Given a set of linearly independent vectors  <span class="math notranslate nohighlight">\(\{V_1, V_2, V_3 ... V_n\}\)</span>, we wish to find an orthonormal set of vectors  <span class="math notranslate nohighlight">\(\{U_1, U_2, U_3 ... U_n\}\)</span> such that the span of  <span class="math notranslate nohighlight">\(\{U_1, U_2, U_3 ... U_n\}\)</span> is the same as the span of  <span class="math notranslate nohighlight">\(\{V_1, V_2, V_3 ... V_n\}\)</span>.  In other words, we want both sets to be bases for the same subspace.</p>
<p>One of the primary advantages of using orthonormal bases is that the calculation of <a class="reference internal" href="Bases.html"><span class="std std-doc">coordinate vectors</span></a> is greatly simplified.  Recall that if we have a typical basis <span class="math notranslate nohighlight">\(\beta = \{V_1, V_2, V_3 ... V_n\}\)</span> for a subspace <span class="math notranslate nohighlight">\(\mathcal{V}\)</span>, and a vector <span class="math notranslate nohighlight">\(X\)</span> in <span class="math notranslate nohighlight">\(\mathcal{V}\)</span>, the coordinates with respect to <span class="math notranslate nohighlight">\(\beta\)</span> are the values of <span class="math notranslate nohighlight">\(c_1\)</span>, <span class="math notranslate nohighlight">\(c_2\)</span>, … ,<span class="math notranslate nohighlight">\(c_n\)</span> such that
<span class="math notranslate nohighlight">\(X = c_1V_1 + c_2V_2 + ... c_nV_n\)</span>.  This requires that we solve the linear system <span class="math notranslate nohighlight">\(A[X]_{\beta}=X\)</span>, where <span class="math notranslate nohighlight">\(A\)</span> is the matrix that has the basis vectors as its columns, and <span class="math notranslate nohighlight">\([X]_\beta\)</span> is the coordinate vector.  If instead we have an orthonormal basis <span class="math notranslate nohighlight">\(\alpha = \{U_1, U_2, U_3 ... U_n\}\)</span> for <span class="math notranslate nohighlight">\(\mathcal{V}\)</span>, there is a convenient shortcut to solving <span class="math notranslate nohighlight">\(X = b_1U_1 + b_2U_2 + ... b_nU_n\)</span>.  Let’s observe the result of taking the dot product of both sides of this equation with <span class="math notranslate nohighlight">\(U_k\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
X\cdot U_k &amp; = &amp; (b_1U_1 + b_2U_2 + ... b_nU_n)\cdot U_k \\
 &amp; = &amp; b_1(U_1\cdot U_k) + b_2(U_2\cdot U_k) + ... b_n(U_n\cdot U_k) \\
 &amp; = &amp; b_k 
\end{eqnarray}
\end{split}\]</div>
<p>All of the products <span class="math notranslate nohighlight">\(U_i\cdot U_k\)</span> are zero except for <span class="math notranslate nohighlight">\(U_k\cdot U_k\)</span>, which is one.  This means that instead of solving a system to find the coordinates, we can compute each <span class="math notranslate nohighlight">\(b_k\)</span> directly, as the dot product <span class="math notranslate nohighlight">\(X\cdot U_k\)</span>.</p>
<section id="projecting-vectors-onto-vectors">
<h2>Projecting vectors onto vectors<a class="headerlink" href="#projecting-vectors-onto-vectors" title="Link to this heading">#</a></h2>
<p>An important step in orthogonalization involves decomposing a vector <span class="math notranslate nohighlight">\(B\)</span> into orthogonal components based on the direction of another vector <span class="math notranslate nohighlight">\(V\)</span>.  Specifically, we want to determine two vectors, <span class="math notranslate nohighlight">\(\hat{B}\)</span> and <span class="math notranslate nohighlight">\(E\)</span>, such that <span class="math notranslate nohighlight">\(\hat{B}\)</span> is in the same direction as <span class="math notranslate nohighlight">\(V\)</span>, <span class="math notranslate nohighlight">\(E\)</span> is orthogonal to <span class="math notranslate nohighlight">\(V\)</span>, and <span class="math notranslate nohighlight">\(B = \hat{B} + E\)</span>.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;head_width&quot;</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span> <span class="s2">&quot;head_length&quot;</span><span class="p">:</span><span class="mf">0.2</span><span class="p">,</span> <span class="s2">&quot;length_includes_head&quot;</span><span class="p">:</span><span class="kc">True</span><span class="p">}</span>

<span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">fc</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">ec</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">fc</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">ec</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">2.8</span><span class="p">,</span><span class="mf">1.4</span><span class="p">,</span><span class="n">fc</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">ec</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mf">2.8</span><span class="p">,</span><span class="mf">1.4</span><span class="p">,</span><span class="o">-</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">1.6</span><span class="p">,</span><span class="n">fc</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">ec</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;$B$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">3.2</span><span class="p">,</span><span class="mf">1.2</span><span class="p">,</span><span class="s1">&#39;$V$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="s1">&#39;$\hat</span><span class="si">{B}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="s1">&#39;$E$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">theta$&#39;</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$x_2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:14: SyntaxWarning: invalid escape sequence &#39;\h&#39;
&lt;&gt;:14: SyntaxWarning: invalid escape sequence &#39;\h&#39;
/tmp/ipykernel_2705/3626316039.py:14: SyntaxWarning: invalid escape sequence &#39;\h&#39;
  ax.text(2,0.6,&#39;$\hat{B}$&#39;)
</pre></div>
</div>
<img alt="_images/6c9412d4772d3caef7bd16ea8de87fb5fef315fcea135415f3a0d4c79b4435cf.png" src="_images/6c9412d4772d3caef7bd16ea8de87fb5fef315fcea135415f3a0d4c79b4435cf.png" />
</div>
</div>
<p>The vector <span class="math notranslate nohighlight">\(\hat{B}\)</span> is said to be the <strong>projection</strong> of <span class="math notranslate nohighlight">\(B\)</span> in the direction of <span class="math notranslate nohighlight">\(V\)</span>.</p>
<p>To find the magnitude of <span class="math notranslate nohighlight">\(\hat{B}\)</span>, we can use the definition of cosine to write <span class="math notranslate nohighlight">\(||\hat{B}|| = ||B||\cos{\theta}\)</span>.  We also know that <span class="math notranslate nohighlight">\(\cos{\theta}\)</span> can be determined using the dot product.</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\cos{\theta} = \frac{B\cdot V}{||B||||V||}
\end{equation}
\]</div>
<p>Combining these facts gives us <span class="math notranslate nohighlight">\(||\hat{B}||\)</span>.</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
||\hat{B}|| = \frac{B\cdot V}{||V||} 
\end{equation}
\]</div>
<p>We can now construct <span class="math notranslate nohighlight">\(\hat{B}\)</span> by multiplying <span class="math notranslate nohighlight">\(||\hat{B}||\)</span> by a unit vector in the direction of <span class="math notranslate nohighlight">\(V\)</span></p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\hat{B} = \frac{B\cdot V}{||V||}\left(\frac{V}{||V||}  \right)  
\end{equation}
\]</div>
<p>Finally, we can give a tidy formula by writing <span class="math notranslate nohighlight">\(||V||^2\)</span> using the dot product.</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\hat{B} = \left(\frac{B\cdot V}{V\cdot V}\right) V 
\end{equation}
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">laguide</span><span class="w"> </span><span class="kn">import</span> <span class="n">DotProduct</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">laguide</span><span class="w"> </span><span class="kn">import</span> <span class="n">Magnitude</span>

<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">]])</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span>

<span class="n">k</span> <span class="o">=</span> <span class="n">DotProduct</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="n">V</span><span class="p">)</span><span class="o">/</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">V</span><span class="p">)</span>

<span class="n">B_hat</span> <span class="o">=</span> <span class="n">k</span><span class="o">*</span><span class="n">V</span>

<span class="nb">print</span><span class="p">(</span><span class="n">B_hat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[2.8]
 [1.4]]
</pre></div>
</div>
</div>
</div>
<p>The easiest way to calculate <span class="math notranslate nohighlight">\(E\)</span> is to first find <span class="math notranslate nohighlight">\(\hat{B}\)</span>, then set <span class="math notranslate nohighlight">\(E = B - \hat{B}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E</span> <span class="o">=</span> <span class="n">B</span> <span class="o">-</span> <span class="n">B_hat</span>
<span class="nb">print</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-0.8]
 [ 1.6]]
</pre></div>
</div>
</div>
</div>
<p>If the calculations are correct, we should see that <span class="math notranslate nohighlight">\(\hat{B}\)</span> and <span class="math notranslate nohighlight">\(E\)</span> are orthogonal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">B_hat</span><span class="p">,</span><span class="n">E</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.440892098500626e-16
</pre></div>
</div>
</div>
</div>
<p>We see in fact that the computed value of <span class="math notranslate nohighlight">\(\hat{B}\cdot E\)</span> is not <em>exactly</em> zero due to the imprecision of the machine arithmetic.  This is very similar to some of the results we observed when performing elimination numerically, and we must keep in mind the potential for such errors.</p>
<p>We also note that the formula derived here for <span class="math notranslate nohighlight">\(\hat{B}\)</span> works for vectors of any dimension.  If <span class="math notranslate nohighlight">\(B\)</span> and <span class="math notranslate nohighlight">\(V\)</span> are vectors in <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>, they still occupy a common plane, and the picture looks just the same as the one above regardless of the fact that the plane sits in a higher dimensional space.</p>
</section>
<section id="gram-schmidt-algorithm">
<h2>Gram-Schmidt algorithm<a class="headerlink" href="#gram-schmidt-algorithm" title="Link to this heading">#</a></h2>
<p>Given a set of linearly independent vectors  <span class="math notranslate nohighlight">\(\{V_1, V_2, V_3 ... V_n\}\)</span>, the <strong>Gram-Schmidt algorithm</strong> produces an orthonormal set of vectors <span class="math notranslate nohighlight">\(\{U_1, U_2, U_3 ... U_n\}\)</span> such that the span of  <span class="math notranslate nohighlight">\(\{U_1, U_2, U_3 ... U_n\}\)</span> is the same as the span of  <span class="math notranslate nohighlight">\(\{V_1, V_2, V_3 ... V_n\}\)</span>.  The idea is to build up the set of <span class="math notranslate nohighlight">\(U\)</span> vectors one at a time, while ensuring that each new vector <span class="math notranslate nohighlight">\(U_i\)</span> that is added is orthogonal to all vectors already in the set.  These vectors are constructed by selecting a vector from the <span class="math notranslate nohighlight">\(V\)</span> set, and subtracting the components that are in the directions of any vectors already in the <span class="math notranslate nohighlight">\(U\)</span> set.  The <span class="math notranslate nohighlight">\(U\)</span> vectors can be scaled to unit length as part of the process, or they can all be scaled at the end.</p>
<p>We write the algorithm in steps before providing an example.</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(V_1\)</span> is scaled to unit length and becomes <span class="math notranslate nohighlight">\(U_1\)</span>.</p></li>
<li><p>The projection of <span class="math notranslate nohighlight">\(V_2\)</span> in the direction of <span class="math notranslate nohighlight">\(U_1\)</span> is subtracted from <span class="math notranslate nohighlight">\(V_2\)</span>.  The resulting vector is scaled to unit length and becomes <span class="math notranslate nohighlight">\(U_2\)</span>.</p></li>
<li><p>The projections of <span class="math notranslate nohighlight">\(V_3\)</span> in the directions of <span class="math notranslate nohighlight">\(U_1\)</span> and <span class="math notranslate nohighlight">\(U_2\)</span> are subtracted from <span class="math notranslate nohighlight">\(V_3\)</span>.  The resulting vector is scaled to unit length and becomes <span class="math notranslate nohighlight">\(U_3\)</span>.</p></li>
<li><p>Continue applying a similar procedure for all <span class="math notranslate nohighlight">\(n\)</span> vectors.  In general, the projections of <span class="math notranslate nohighlight">\(V_k\)</span> in the directions of <span class="math notranslate nohighlight">\(U_1\)</span>, <span class="math notranslate nohighlight">\(U_2\)</span>, …<span class="math notranslate nohighlight">\(U_{k-1}\)</span> are subtracted from <span class="math notranslate nohighlight">\(V_k\)</span> and the resulting vector is scaled to unit length to become <span class="math notranslate nohighlight">\(U_k\)</span>.</p></li>
</ol>
</section>
<section id="example-1-applying-the-gram-schmidt-algorithm">
<h2>Example 1:  Applying the Gram-Schmidt algorithm<a class="headerlink" href="#example-1-applying-the-gram-schmidt-algorithm" title="Link to this heading">#</a></h2>
<p>As a first example, we take three vectors from <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span> as the starting set, and use Python to carry out the calculations.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
V_1 = \left[ \begin{array}{r} 1 \\ 2 \\ 0 \end{array}\right] \hspace{0.7cm} 
V_2 = \left[ \begin{array}{r} 1 \\ 1 \\ 1 \end{array}\right] \hspace{0.7cm}
V_3 = \left[ \begin{array}{r} 3 \\ 0 \\ 1 \end{array}\right] \hspace{0.7cm}
\end{equation}
\end{split}\]</div>
<p>The first vector, <span class="math notranslate nohighlight">\(V_1\)</span> is scaled to unit legth to become <span class="math notranslate nohighlight">\(U_1\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">V_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">V_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">U_1</span> <span class="o">=</span> <span class="n">V_1</span><span class="o">/</span><span class="n">Magnitude</span><span class="p">(</span><span class="n">V_1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">U_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.4472136 ]
 [0.89442719]
 [0.        ]]
</pre></div>
</div>
</div>
</div>
<p>To build <span class="math notranslate nohighlight">\(U_2\)</span>, we first subtract from <span class="math notranslate nohighlight">\(V_2\)</span> the projection of <span class="math notranslate nohighlight">\(V_2\)</span> in the direction of <span class="math notranslate nohighlight">\(U_1\)</span>.  The resulting vector is then scaled to unit length.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W_2</span> <span class="o">=</span> <span class="n">V_2</span> <span class="o">-</span> <span class="p">(</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">V_2</span><span class="p">,</span><span class="n">U_1</span><span class="p">))</span><span class="o">*</span><span class="n">U_1</span>
<span class="n">U_2</span> <span class="o">=</span> <span class="n">W_2</span><span class="o">/</span><span class="n">Magnitude</span><span class="p">(</span><span class="n">W_2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">U_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 0.36514837]
 [-0.18257419]
 [ 0.91287093]]
</pre></div>
</div>
</div>
</div>
<p>Here we labeled the intermediate result as <span class="math notranslate nohighlight">\(W_2\)</span> in order to break the computation into shorter steps.</p>
<p>In the final step, we subtract from <span class="math notranslate nohighlight">\(V_3\)</span> the projections of <span class="math notranslate nohighlight">\(V_3\)</span> in the directions of <span class="math notranslate nohighlight">\(U_1\)</span> and <span class="math notranslate nohighlight">\(U_2\)</span>, and then scale the result.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W_3</span> <span class="o">=</span> <span class="n">V_3</span> <span class="o">-</span> <span class="p">(</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">V_3</span><span class="p">,</span><span class="n">U_1</span><span class="p">))</span><span class="o">*</span><span class="n">U_1</span> <span class="o">-</span> <span class="p">(</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">V_3</span><span class="p">,</span><span class="n">U_2</span><span class="p">))</span><span class="o">*</span><span class="n">U_2</span>
<span class="n">U_3</span> <span class="o">=</span> <span class="n">W_3</span><span class="o">/</span><span class="n">Magnitude</span><span class="p">(</span><span class="n">W_3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">U_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 0.81649658]
 [-0.40824829]
 [-0.40824829]]
</pre></div>
</div>
</div>
</div>
<p>We can check now that the <span class="math notranslate nohighlight">\(U\)</span> vectors are mutually orthogonal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">U_1</span><span class="p">,</span><span class="n">U_2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">U_1</span><span class="p">,</span><span class="n">U_3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">U_2</span><span class="p">,</span><span class="n">U_3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.551115123125783e-17
0.0
-5.551115123125783e-17
</pre></div>
</div>
</div>
</div>
<p>After completing this example, we write down the steps of the process for a set of <span class="math notranslate nohighlight">\(n\)</span> vectors.  For each <span class="math notranslate nohighlight">\(i = 1, 2, ... n\)</span>, we set:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(W_i = V_i - (V_i \cdot U_1)U_1 - (V_i\cdot U_2)U_2 ... - (V_i\cdot U_{i-1})U_{i-1}\)</span><br />
<span class="math notranslate nohighlight">\(U_i = W_i/||W_i||\)</span></p>
</div></blockquote>
<p>It is important to notice here that in general <span class="math notranslate nohighlight">\(U_i\)</span> is a linear combination of <span class="math notranslate nohighlight">\(\{V_1, V_2, ..., V_{i}\}\)</span>.  This means that in addition to the span of <span class="math notranslate nohighlight">\(\{U_1, U_2, U_3 ... U_n\}\)</span> being the same as the span of <span class="math notranslate nohighlight">\(\{V_1, V_2, V_3 ..., V_n\}\)</span>, it is also true that the span of <span class="math notranslate nohighlight">\(\{U_1, U_2, ..., U_i\}\)</span> is the same as the span of <span class="math notranslate nohighlight">\(\{V_1, V_2, ..., V_i\}\)</span> for every <span class="math notranslate nohighlight">\(i\)</span>.  This has important implications in the next section.</p>
</section>
<section id="orthogonal-matrices">
<h2>Orthogonal matrices<a class="headerlink" href="#orthogonal-matrices" title="Link to this heading">#</a></h2>
<p>Another way we could check that the set of vectors <span class="math notranslate nohighlight">\(\{U_1, U_2, U_3\}\)</span> is orthonormal is to assemble a matrix with these vectors as the columns and take advantage of the connection between matrix multiplications and dot products.  Suppose that <span class="math notranslate nohighlight">\(Q\)</span> is the matrix with <span class="math notranslate nohighlight">\(U_1\)</span>, <span class="math notranslate nohighlight">\(U_2\)</span>, and <span class="math notranslate nohighlight">\(U_3\)</span> as its columns.  If we compute the matrix product <span class="math notranslate nohighlight">\(Q^TQ\)</span>, the entries will be the dot products between the rows of <span class="math notranslate nohighlight">\(Q^T\)</span> and columns of <span class="math notranslate nohighlight">\(Q\)</span>, both of which are the set of <span class="math notranslate nohighlight">\(U\)</span> vectors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">U_1</span><span class="p">,</span><span class="n">U_2</span><span class="p">,</span><span class="n">U_3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">I</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@Q</span>
<span class="nb">print</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1">## Round the entries to 8 decimal places</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 0.4472136   0.36514837  0.81649658]
 [ 0.89442719 -0.18257419 -0.40824829]
 [ 0.          0.91287093 -0.40824829]] 

[[ 1.00000000e+00  5.21392112e-17 -1.14826894e-17]
 [ 5.21392112e-17  1.00000000e+00 -6.57870242e-17]
 [-1.14826894e-17 -6.57870242e-17  1.00000000e+00]] 

[[ 1.  0. -0.]
 [ 0.  1. -0.]
 [-0. -0.  1.]]
</pre></div>
</div>
</div>
</div>
<p>We see that <span class="math notranslate nohighlight">\(U_i\cdot U_j\)</span> is 0 if <span class="math notranslate nohighlight">\(i\neq j\)</span> and 1 if <span class="math notranslate nohighlight">\(i=j\)</span>, which means that <span class="math notranslate nohighlight">\(Q^TQ\)</span> is the identity matrix <span class="math notranslate nohighlight">\(I\)</span>.  (<em>Note the use of <span class="math notranslate nohighlight">\(\texttt{round}\)</span> for display purposes.</em>)</p>
<p>The matrix <span class="math notranslate nohighlight">\(Q\)</span> is called an <strong>orthogonal matrix</strong>, which means that its columns form a set of orthonormal vectors.  An immediate result of this definition is that if <span class="math notranslate nohighlight">\(Q\)</span> is an orthogonal matrix, then <span class="math notranslate nohighlight">\(Q^TQ = I\)</span>.  In the special case that <span class="math notranslate nohighlight">\(Q\)</span> is square, this equation implies that <span class="math notranslate nohighlight">\(Q^T = Q^{-1}\)</span>.</p>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<p><strong>Exercise 1:</strong>  Explain why a set of nonzero mutually orthogonal vectors must be linearly independent.</p>
<p><strong>Exercise 2:</strong>  Derive the formula for the projection of <span class="math notranslate nohighlight">\(B\)</span> onto <span class="math notranslate nohighlight">\(V\)</span> in another way that doesn’t involve <span class="math notranslate nohighlight">\(\cos{\theta}\)</span>.  Let <span class="math notranslate nohighlight">\(\hat{B} = kV\)</span>, where <span class="math notranslate nohighlight">\(k\)</span> is an unknown scalar.  Now use <span class="math notranslate nohighlight">\(\hat{B}\cdot E\)</span> to determine <span class="math notranslate nohighlight">\(k\)</span> directly.</p>
<p><strong>Exercise 3:</strong> The set <span class="math notranslate nohighlight">\(\beta = \{U_1, U_2, U_3\}\)</span> is an orthonormal basis for <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
U_1 = \frac{1}{\sqrt{6}}\left[ \begin{array}{r} 2 \\ 1 \\ 1 \end{array}\right] \hspace{0.7cm} 
U_2 = \frac{1}{\sqrt{2}}\left[ \begin{array}{r} 0 \\ -1 \\ 1 \end{array}\right] \hspace{0.7cm}
U_3 = \frac{1}{\sqrt{3}}\left[ \begin{array}{r} -1 \\ 1 \\ 1 \end{array}\right] \hspace{0.7cm}
\end{equation}
\end{split}\]</div>
<p>(<span class="math notranslate nohighlight">\(a\)</span>) Define <span class="math notranslate nohighlight">\(Q\)</span> as the matrix with columns <span class="math notranslate nohighlight">\(U_1\)</span>, <span class="math notranslate nohighlight">\(U_2\)</span>, and <span class="math notranslate nohighlight">\(U_3\)</span>.  Verify that <span class="math notranslate nohighlight">\(Q^TQ=I\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here.</span>
</pre></div>
</div>
</div>
</div>
<p>(<span class="math notranslate nohighlight">\(b\)</span>) Let <span class="math notranslate nohighlight">\(X\)</span> be the following vector, and compute <span class="math notranslate nohighlight">\([X]_{\beta}\)</span> by solving <span class="math notranslate nohighlight">\(Q[X]
_{\beta}= X\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X = \left[ \begin{array}{r} 3 \\ 1 \\ -4 \end{array}\right] 
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here.</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 4:</strong> Find a vector that is orthogonal to the column space of the matrix <span class="math notranslate nohighlight">\(A\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
A = \left[ \begin{array}{rr} 1 &amp; 2\\ 2 &amp; 0 \\ 3 &amp; 1\end{array}\right] 
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 5:</strong> Let <span class="math notranslate nohighlight">\(\mathcal{U}\)</span> be the subspace spanned by <span class="math notranslate nohighlight">\(\{V_1,V_2\}\)</span>. Apply the Gram-Schimdt orthogonalization on the basis <span class="math notranslate nohighlight">\(\{V_1,V_2\}\)</span> to produce an orthonormal basis <span class="math notranslate nohighlight">\(\{U_1,U_2\}\)</span> for <span class="math notranslate nohighlight">\(\mathcal{U}\)</span>.  Verify that <span class="math notranslate nohighlight">\(\{U_1,U_2\}\)</span> is an orthonormal basis with a computation.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
V_1 = \left[ \begin{array}{r} 1 \\ 1 \\ 2 \end{array}\right] \hspace{1cm}
V_2 = \left[ \begin{array}{r} 2 \\ 1 \\ 3 \end{array}\right] 
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 6:</strong> Let <span class="math notranslate nohighlight">\(\mathcal{U}\)</span> be the subspace spanned by <span class="math notranslate nohighlight">\(\{X_1,X_2\}\)</span>. Apply the Gram-Schimdt orthogonalization on the basis <span class="math notranslate nohighlight">\(\{X_1,X_2\}\)</span> to produce an orthonormal basis <span class="math notranslate nohighlight">\(\{U_1,U_2\}\)</span> for <span class="math notranslate nohighlight">\(\mathcal{U}\)</span>.  Verify that <span class="math notranslate nohighlight">\(\{U_1,U_2\}\)</span> is an orthonormal basis with a computation.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X_1 = \left[ \begin{array}{r} 1 \\ 0 \\ 2 \\ 2 \end{array}\right] \hspace{0.7cm} 
X_2 = \left[ \begin{array}{r} -2 \\ 1 \\ 0 \\ -1 \end{array}\right]
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here.</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 7:</strong> Let <span class="math notranslate nohighlight">\(V\)</span> be a vector in <span class="math notranslate nohighlight">\(\mathbb{R}^4\)</span>. Explain why the set of vectors orthogonal to <span class="math notranslate nohighlight">\(V\)</span> is a subspace of <span class="math notranslate nohighlight">\(\mathbb{R}^4\)</span>.</p>
<p><strong>Exercise 8:</strong> Given vectors <span class="math notranslate nohighlight">\(V\)</span> and <span class="math notranslate nohighlight">\(W\)</span>, find vectors <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> such that <span class="math notranslate nohighlight">\(X\)</span> is the projection of <span class="math notranslate nohighlight">\(V\)</span> in the direction of <span class="math notranslate nohighlight">\(W\)</span> and <span class="math notranslate nohighlight">\(V = X + Y\)</span> .Verify your answer.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
V = \left[ \begin{array}{r} 
9\\ 5 \\ 0 \end{array}\right] \hspace{1cm}
W = \left[ \begin{array}{r} 3 \\ 0 \\ 3 \end{array}\right] 
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 9:</strong> Let <span class="math notranslate nohighlight">\(U\)</span> be a vector space spanned by the columns of <span class="math notranslate nohighlight">\(A\)</span>. Find an orthonormal basis for <span class="math notranslate nohighlight">\(U\)</span> to generate an orthogonal matrix <span class="math notranslate nohighlight">\(Q\)</span>. Verify that <span class="math notranslate nohighlight">\(Q^TQ = I\)</span> where <span class="math notranslate nohighlight">\(I\)</span> is the identity matrix.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
A = \left[ \begin{array}{r} 1 &amp; 2 &amp; -1\\ 0 &amp; 2 &amp; 1 \\  1 &amp; 1 &amp; 2 \end{array}\right]  
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 10:</strong> Consider two vectors <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>. Given that <span class="math notranslate nohighlight">\(Z\)</span> is the projection of <span class="math notranslate nohighlight">\(X\)</span> in the direction of <span class="math notranslate nohighlight">\(Y\)</span> and <span class="math notranslate nohighlight">\(X \cdot Y = 6\)</span>, find <span class="math notranslate nohighlight">\(Y\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X = \left[ \begin{array}{r} 2\\ 1 \\ 1 \end{array}\right] \hspace{1cm}
Z = \left[ \begin{array}{r} 1 \\ 1 \\ 0 \end{array}\right] 
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "executablebooks/jupyter-book",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Inner_Products.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Inner Products</p>
      </div>
    </a>
    <a class="right-next"
       href="QR_Factorization.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">QR Factorization</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#projecting-vectors-onto-vectors">Projecting vectors onto vectors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gram-schmidt-algorithm">Gram-Schmidt algorithm</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-applying-the-gram-schmidt-algorithm">Example 1:  Applying the Gram-Schmidt algorithm</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#orthogonal-matrices">Orthogonal matrices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Aditya Chaturvedi
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>