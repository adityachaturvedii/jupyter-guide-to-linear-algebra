
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>QR Factorization &#8212; Jupyter Guide to Linear Algebra</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'QR_Factorization';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Orthogonal Subspaces" href="Orthogonal_Subspaces.html" />
    <link rel="prev" title="Orthogonalization" href="Orthogonalization.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/reflection_logo.png" class="logo__image only-light" alt="Jupyter Guide to Linear Algebra - Home"/>
    <script>document.write(`<img src="_static/reflection_logo.png" class="logo__image only-dark" alt="Jupyter Guide to Linear Algebra - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to the Jupyter Guide to Linear Algebra
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="Jupyter_Introduction.html">Introduction to Jupyter</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Python_Introduction.html">Introduction to Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="Numpy_Introduction.html">Introduction to NumPy and Matplotlib</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Linear_Systems.html">Linear Systems</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Gaussian_Elimination.html">Gaussian Elimination</a></li>
<li class="toctree-l2"><a class="reference internal" href="Matrix_Algebra.html">Matrix Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="Solving_Systems.html">Solving Systems using Elimination</a></li>
<li class="toctree-l2"><a class="reference internal" href="Inverse_Matrices.html">Inverse Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="LU_Factorization.html">LU Factorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="Applications.html">Applications of Linear Systems and Matrix Algebra</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Vector_Spaces.html">Vector Spaces</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="General_Linear_Systems.html">General Linear Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="Linear_Combinations.html">Linear Combinations</a></li>
<li class="toctree-l2"><a class="reference internal" href="Linear_Independence.html">Linear Independence</a></li>
<li class="toctree-l2"><a class="reference internal" href="Bases.html">Bases</a></li>
<li class="toctree-l2"><a class="reference internal" href="Vector_Space_Examples.html">Vector Space Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="Applications_VS.html">Applications of Vector Spaces</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Linear_Transformations.html">Linear Transformations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Matrix_Representations.html">Matrix Representations</a></li>
<li class="toctree-l2"><a class="reference internal" href="Planar_Transformations.html">Transformations in a Plane</a></li>
<li class="toctree-l2"><a class="reference internal" href="Applications_LT.html">Applications of Linear Transformations</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="Inner_Products.html">Inner Products</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Orthogonalization.html">Orthogonalization</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">QR Factorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="Orthogonal_Subspaces.html">Orthogonal Subspaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="Least_Squares_Solutions.html">Least Squares Solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Projections.html">Projections</a></li>
<li class="toctree-l2"><a class="reference internal" href="Applications_IP.html">Applications of Inner Products</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Eigenvalues.html">Eigenvalues</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Diagonalization.html">Diagonalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="Approximating_Eigenvalues.html">Approximating Eigenvalues</a></li>
<li class="toctree-l2"><a class="reference internal" href="Applications_EV.html">Applications of Eigenvalues and Eigenvectors</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Solutions.html">Solutions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Introduction_Solutions.html">Introduction to Jupyter</a></li>
<li class="toctree-l2"><a class="reference internal" href="Linear_Systems_Solutions.html">Linear Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="Vector_Spaces_Solutions.html">Vector Spaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="Linear_Transformations_Solutions.html">Linear Transformations</a></li>
<li class="toctree-l2"><a class="reference internal" href="Inner_Products_Solutions.html">Inner Products</a></li>
<li class="toctree-l2"><a class="reference internal" href="Eigenvalues_Solutions.html">Eigenvalues</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/QR_Factorization.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>QR Factorization</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#structure-of-orthogonalization">Structure of orthogonalization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-finding-a-qr-factorization">Example 1:  Finding a QR factorization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#qr-factorization-function">QR factorization function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-solving-a-linear-system">Example 2:  Solving a linear system</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#qr-factorization-with-scipy">QR factorization with SciPy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="qr-factorization">
<h1>QR Factorization<a class="headerlink" href="#qr-factorization" title="Link to this heading">#</a></h1>
<p>In Chapter 1 we saw that the LU factorization essentially captured the elimination process and stored the result in a way that allowed us to use elimination to solve similar systems without having to carry out the elimination again.  The QR factorization accomplishes something similar for the orthogonalization process.  Given a matrix <span class="math notranslate nohighlight">\(A\)</span> with linearly independent columns, the QR factorization of <span class="math notranslate nohighlight">\(A\)</span> is a pair of matrices <span class="math notranslate nohighlight">\(Q\)</span> and <span class="math notranslate nohighlight">\(R\)</span> such that <span class="math notranslate nohighlight">\(Q\)</span> is orthogonal, <span class="math notranslate nohighlight">\(R\)</span> is upper triangular, and <span class="math notranslate nohighlight">\(QR=A\)</span>.</p>
<section id="structure-of-orthogonalization">
<h2>Structure of orthogonalization<a class="headerlink" href="#structure-of-orthogonalization" title="Link to this heading">#</a></h2>
<p>If <span class="math notranslate nohighlight">\(A\)</span> is an <span class="math notranslate nohighlight">\(m\times n\)</span> matrix with linearly independent columns, it must be that <span class="math notranslate nohighlight">\(m \ge n\)</span>.  The matrix <span class="math notranslate nohighlight">\(Q\)</span> then will be <span class="math notranslate nohighlight">\(m\times n\)</span> with orthonormal columns, and <span class="math notranslate nohighlight">\(R\)</span> will be <span class="math notranslate nohighlight">\(n\times n\)</span> and upper triangular.  For example, if <span class="math notranslate nohighlight">\(A\)</span> is a <span class="math notranslate nohighlight">\(6\times 4\)</span> matrix, the matrices have the following structures, with the <span class="math notranslate nohighlight">\(A_i\)</span> and <span class="math notranslate nohighlight">\(U_i\)</span> being vectors in <span class="math notranslate nohighlight">\(\mathbb{R}^6\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
A =  \left[ \begin{array}{c|c|c|c} &amp; &amp; &amp; \\
A_1 &amp; A_2 &amp; A_3 &amp; A_4 \\ &amp; &amp; &amp; \end{array} \right] \hspace{2cm}
Q =  \left[ \begin{array}{c|c|c|c} &amp; &amp; &amp; \\
U_1 &amp; U_2 &amp; U_3 &amp; U_4 \\ &amp; &amp; &amp; \end{array} \right] \hspace{2cm}
R = \left[ \begin{array}{cccc} * &amp; * &amp; * &amp; * \\ 0 &amp; * &amp; * &amp; * \\ 0 &amp; 0 &amp; * &amp; * \\ 0 &amp; 0 &amp; 0 &amp; *  \end{array}\right]
\end{equation}
\end{split}\]</div>
<p>The columns of <span class="math notranslate nohighlight">\(Q\)</span> are the result of applying the orthogonalization process to the columns of <span class="math notranslate nohighlight">\(A\)</span>.  If we suppose that this is the case, let’s explain why <span class="math notranslate nohighlight">\(R\)</span> must be triangular by looking at the product <span class="math notranslate nohighlight">\(QR\)</span> one column at a time.  For the first column we have the following vector equation which specifies the linear combination of the <span class="math notranslate nohighlight">\(U\)</span> vectors that form <span class="math notranslate nohighlight">\(A_1\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
\left[ \begin{array}{c|c|c|c} &amp; &amp; &amp; \\
U_1 &amp; U_2 &amp; U_3 &amp; U_4 \\ &amp; &amp; &amp; \end{array} \right]
\left[ \begin{array}{c} r_{11} \\ r_{21} \\ r_{31} \\ r_{41} \end{array} \right]
= r_{11}U_1 + r_{21}U_2 + r_{31}U_3 + r_{41}U_4 = A_1
\end{equation}
\end{split}\]</div>
<p>We know however that <span class="math notranslate nohighlight">\(U_1\)</span> is the unit vector in the direction of <span class="math notranslate nohighlight">\(A_1\)</span>.  This means that <span class="math notranslate nohighlight">\(r_{21}=r_{31}=r_{41}=0\)</span> and
<span class="math notranslate nohighlight">\(r_{11} = |A_1|\)</span>.  Let’s also note that  <span class="math notranslate nohighlight">\(|A_1| = U_1\cdot A_1\)</span>.</p>
<p>For the second column we have a similar equation.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
\left[ \begin{array}{c|c|c|c} &amp; &amp; &amp; \\
U_1 &amp; U_2 &amp; U_3 &amp; U_4 \\ &amp; &amp; &amp; \end{array} \right]
\left[ \begin{array}{c} r_{12} \\ r_{22} \\ r_{32} \\ r_{42} \end{array} \right]
= r_{12}U_1 + r_{22}U_2 + r_{32}U_3 + r_{42}U_4 = A_2
\end{equation}
\end{split}\]</div>
<p>We know from the orthogonalization process that <span class="math notranslate nohighlight">\(U_2\)</span> is built by subtracting from <span class="math notranslate nohighlight">\(A_2\)</span> the component that is in the <span class="math notranslate nohighlight">\(U_1\)</span> direction.  Thus, <span class="math notranslate nohighlight">\(A_2\)</span> is a linear combination of <span class="math notranslate nohighlight">\(U_1\)</span> and <span class="math notranslate nohighlight">\(U_2\)</span>.  This means that <span class="math notranslate nohighlight">\(r_{32}=r_{42}=0\)</span> and <span class="math notranslate nohighlight">\(r_{12}\)</span> and <span class="math notranslate nohighlight">\(r_{22}\)</span> are the coordinates of <span class="math notranslate nohighlight">\(A_2\)</span> with respect to <span class="math notranslate nohighlight">\(U_1\)</span> and <span class="math notranslate nohighlight">\(U_2\)</span>, which we can compute as <span class="math notranslate nohighlight">\(r_{12} = U_1\cdot A_2\)</span> and
<span class="math notranslate nohighlight">\(r_{22} = U_2\cdot A_2\)</span>.</p>
<p>Carrying out the same reasoning for the last two columns, we find that in general <span class="math notranslate nohighlight">\(r_{ij} = U_i\cdot A_j\)</span> and that <span class="math notranslate nohighlight">\(r_{ij} = 0\)</span> for <span class="math notranslate nohighlight">\(i&gt;j\)</span> because the span of <span class="math notranslate nohighlight">\(\{U_1, U_2, ..., U_i\}\)</span> is equal to the span of <span class="math notranslate nohighlight">\(\{A_1, A_2, ..., A_i\}\)</span>.</p>
<p>To arrive at this conclusion this more succinctly, we could multiply the equation <span class="math notranslate nohighlight">\(A=QR\)</span> by <span class="math notranslate nohighlight">\(Q^T\)</span>, which gives <span class="math notranslate nohighlight">\(Q^TA=Q^TQR\)</span> and <span class="math notranslate nohighlight">\(Q^TA = R\)</span> since <span class="math notranslate nohighlight">\(Q^TQ = I\)</span>.  If we then understand the matrix product <span class="math notranslate nohighlight">\(Q^TA\)</span> as a collection of dot products between rows of <span class="math notranslate nohighlight">\(Q^T\)</span> and columns of <span class="math notranslate nohighlight">\(A\)</span>, we have again that <span class="math notranslate nohighlight">\(r_{ij} = U_i \cdot A_j\)</span>.</p>
</section>
<section id="example-1-finding-a-qr-factorization">
<h2>Example 1:  Finding a QR factorization<a class="headerlink" href="#example-1-finding-a-qr-factorization" title="Link to this heading">#</a></h2>
<p>Let’s compute the QR factorization for a specific <span class="math notranslate nohighlight">\(6\times 4 \)</span> matrix.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
A = \left[ \begin{array}{rrrr} 
1 &amp; 3 &amp; 2 &amp; 0 \\ 
0 &amp; -1 &amp; -1 &amp; 0 \\ 
2 &amp; 2 &amp; 1 &amp; 1 \\
-1 &amp; 1 &amp; 3 &amp; 4 \\
-4 &amp; 0 &amp; 1 &amp; -2 \\
0 &amp; -1 &amp; -2 &amp; 5 \\
\end{array}\right]
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">laguide</span><span class="w"> </span><span class="kn">import</span> <span class="n">DotProduct</span> <span class="k">as</span> <span class="n">Dot</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">laguide</span><span class="w"> </span><span class="kn">import</span> <span class="n">Magnitude</span>

<span class="c1"># Define A</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>

<span class="c1"># Slice out the columns of A for processing</span>
<span class="n">A_1</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="n">A_2</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">A_3</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="n">A_4</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>

<span class="c1"># Carry out Gram-Schmidt process</span>
<span class="n">U_1</span> <span class="o">=</span> <span class="n">A_1</span><span class="o">/</span><span class="n">Magnitude</span><span class="p">(</span><span class="n">A_1</span><span class="p">)</span>
<span class="n">W_2</span> <span class="o">=</span> <span class="n">A_2</span> <span class="o">-</span> <span class="n">Dot</span><span class="p">(</span><span class="n">A_2</span><span class="p">,</span><span class="n">U_1</span><span class="p">)</span><span class="o">*</span><span class="n">U_1</span>
<span class="n">U_2</span> <span class="o">=</span> <span class="n">W_2</span><span class="o">/</span><span class="n">Magnitude</span><span class="p">(</span><span class="n">W_2</span><span class="p">)</span>
<span class="n">W_3</span> <span class="o">=</span> <span class="n">A_3</span> <span class="o">-</span> <span class="n">Dot</span><span class="p">(</span><span class="n">A_3</span><span class="p">,</span><span class="n">U_1</span><span class="p">)</span><span class="o">*</span><span class="n">U_1</span> <span class="o">-</span> <span class="n">Dot</span><span class="p">(</span><span class="n">A_3</span><span class="p">,</span><span class="n">U_2</span><span class="p">)</span><span class="o">*</span><span class="n">U_2</span>
<span class="n">U_3</span> <span class="o">=</span> <span class="n">W_3</span><span class="o">/</span><span class="n">Magnitude</span><span class="p">(</span><span class="n">W_3</span><span class="p">)</span>
<span class="n">W_4</span> <span class="o">=</span> <span class="n">A_4</span> <span class="o">-</span> <span class="n">Dot</span><span class="p">(</span><span class="n">A_4</span><span class="p">,</span><span class="n">U_1</span><span class="p">)</span><span class="o">*</span><span class="n">U_1</span> <span class="o">-</span> <span class="n">Dot</span><span class="p">(</span><span class="n">A_4</span><span class="p">,</span><span class="n">U_2</span><span class="p">)</span><span class="o">*</span><span class="n">U_2</span> <span class="o">-</span> <span class="n">Dot</span><span class="p">(</span><span class="n">A_4</span><span class="p">,</span><span class="n">U_3</span><span class="p">)</span><span class="o">*</span><span class="n">U_3</span>
<span class="n">U_4</span> <span class="o">=</span> <span class="n">W_4</span><span class="o">/</span><span class="n">Magnitude</span><span class="p">(</span><span class="n">W_4</span><span class="p">)</span>

<span class="c1"># Assemble the matrix Q</span>

<span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">U_1</span><span class="p">,</span><span class="n">U_2</span><span class="p">,</span><span class="n">U_3</span><span class="p">,</span><span class="n">U_4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Q&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Check that Q is orthogonal</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;QTQ&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@Q</span><span class="p">),</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Compute R</span>

<span class="n">R</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@A</span>

<span class="c1">#  Check</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Q&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;QR&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Q</span><span class="nd">@R</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Q
[[ 0.21320072  0.71960864 -0.32643805  0.03625532]
 [ 0.         -0.2638565   0.01525411 -0.00954087]
 [ 0.42640143  0.38379127 -0.10982963  0.09922508]
 [-0.21320072  0.33581737  0.74745161  0.52474801]
 [-0.85280287  0.28784346 -0.32338723 -0.07251063]
 [ 0.         -0.2638565  -0.46677591  0.84150499]] 

QTQ
[[ 1.  0. -0.  0.]
 [ 0.  1. -0.  0.]
 [-0. -0.  1.  0.]
 [ 0.  0.  0.  1.]] 

Q
[[ 0.21320072  0.71960864 -0.32643805  0.03625532]
 [ 0.         -0.2638565   0.01525411 -0.00954087]
 [ 0.42640143  0.38379127 -0.10982963  0.09922508]
 [-0.21320072  0.33581737  0.74745161  0.52474801]
 [-0.85280287  0.28784346 -0.32338723 -0.07251063]
 [ 0.         -0.2638565  -0.46677591  0.84150499]] 

R
[[ 4.69041576  1.2792043  -0.63960215  1.2792043 ]
 [ 0.          3.78993883  3.90987361 -0.16790868]
 [-0.         -0.          2.07455958  1.19287176]
 [ 0.          0.          0.          6.55076331]] 

QR
[[ 1.  3.  2. -0.]
 [-0. -1. -1. -0.]
 [ 2.  2.  1.  1.]
 [-1.  1.  3.  4.]
 [-4.  0.  1. -2.]
 [ 0. -1. -2.  5.]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="qr-factorization-function">
<h2>QR factorization function<a class="headerlink" href="#qr-factorization-function" title="Link to this heading">#</a></h2>
<p>It is helpful to write some code in a more general way so that we may easily carry out the factorization on an arbitrary matrix with linearly independent columns.  We will include in our function a simple check of the dimensions of the input matrix.  If the number of columns is greater than the number of rows, the columns cannot be linearly independent since the number of columns exceeds the dimension of the column space.  If this is the case, we will return an error message and not carry out any computations.  If the number of columns is not greater than the number of rows, we will leave it to the user of the function to check that the columns are linearly independent.  We can document this requirement with a comment in the code.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">QRFactorization</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="c1"># =============================================================================</span>
    <span class="c1"># A is a Numpy array that represents a matrix of dimension m x n.</span>
    <span class="c1"># QRFactorization returns matrices Q and R such that A=QR, Q is orthogonal</span>
    <span class="c1"># and R is upper triangular.  The factorization is carried out using classical</span>
    <span class="c1"># Gram-Schmidt and the results may suffer due to numerical instability.</span>
    <span class="c1"># QRFactorization may not return correct results if the columns of A are </span>
    <span class="c1"># linearly dependent.</span>
    <span class="c1"># =============================================================================</span>

    <span class="c1"># Check shape of A</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A must have more rows than columns for QR factorization.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">W</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
                <span class="n">W</span> <span class="o">=</span> <span class="n">W</span> <span class="o">-</span> <span class="n">Dot</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">Q</span><span class="p">[:,</span><span class="n">j</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">Q</span><span class="p">[:,</span><span class="n">j</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Q</span><span class="p">[:,</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">W</span><span class="o">/</span><span class="n">Magnitude</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
        
    <span class="n">R</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@A</span>
    
    <span class="k">return</span> <span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="n">R</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>One point to note here is that our function returns the pair of matrices <span class="math notranslate nohighlight">\(Q\)</span> and <span class="math notranslate nohighlight">\(R\)</span>.  In order to receive both results, we need to assign a pair of names to the output.  This is exactly the same behavior as the SciPy function we used in Chapter 1 to compute the <a class="reference internal" href="LU_Factorization.html"><span class="std std-doc">PLU factorization</span></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span><span class="p">,</span><span class="n">R</span> <span class="o">=</span> <span class="n">QRFactorization</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 0.21320072  0.71960864 -0.32643805  0.03625532]
 [ 0.         -0.2638565   0.01525411 -0.00954087]
 [ 0.42640143  0.38379127 -0.10982963  0.09922508]
 [-0.21320072  0.33581737  0.74745161  0.52474801]
 [-0.85280287  0.28784346 -0.32338723 -0.07251063]
 [ 0.         -0.2638565  -0.46677591  0.84150499]]


[[ 4.69041576  1.2792043  -0.63960215  1.2792043 ]
 [ 0.          3.78993883  3.90987361 -0.16790868]
 [-0.         -0.          2.07455958  1.19287176]
 [ 0.          0.          0.          6.55076331]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="example-2-solving-a-linear-system">
<h2>Example 2:  Solving a linear system<a class="headerlink" href="#example-2-solving-a-linear-system" title="Link to this heading">#</a></h2>
<p>The orthogonalization behind the <span class="math notranslate nohighlight">\(QR\)</span> factorization provides us another way to solve a linear system <span class="math notranslate nohighlight">\(AX=B\)</span>.  If we substitute <span class="math notranslate nohighlight">\(A=QR\)</span>, then multiply the equation by <span class="math notranslate nohighlight">\(Q^T\)</span>, we get <span class="math notranslate nohighlight">\(Q^TQRX = Q^TB\)</span>.  Once again <span class="math notranslate nohighlight">\(Q^TQ\)</span> simplifies to <span class="math notranslate nohighlight">\(I\)</span>, so we are left with <span class="math notranslate nohighlight">\(RX=Q^TB\)</span>, which is a triangular system that can be solved easily by back substitution.</p>
<p>Let’s try it out on a <span class="math notranslate nohighlight">\(4\times 4\)</span> system.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
\left[ \begin{array}{rrrr} 
2 &amp; 3 &amp; 0 &amp; -1 \\ 
-1 &amp; 0 &amp; 2 &amp; 0 \\ 
-1 &amp; -1 &amp; 4 &amp; 2 \\
0 &amp; 3 &amp; -3 &amp; 2 \\
\end{array}\right]X = 
\left[ \begin{array}{r} 0 \\ 1 \\ 2 \\ 5 \end{array} \right]
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">laguide</span><span class="w"> </span><span class="kn">import</span> <span class="n">BackSubstitution</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>

<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">5</span><span class="p">]])</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">Q</span><span class="p">,</span><span class="n">R</span> <span class="o">=</span> <span class="n">QRFactorization</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@B</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">BackSubstitution</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">C</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1">## Check that AX = B</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">A</span><span class="nd">@X</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-1.]
 [ 1.]
 [-0.]
 [ 1.]] 

[[0.]
 [1.]
 [2.]
 [5.]]
</pre></div>
</div>
</div>
</div>
<p>In some situations, we might find that we are solving several systems such as <span class="math notranslate nohighlight">\(AX=B_1\)</span>, <span class="math notranslate nohighlight">\(AX=B_2\)</span>, <span class="math notranslate nohighlight">\(AX=B_3\)</span>, …, that involve the same matrix but different right hand sides.  In these situations it is useful to solve the systems with a factorization such as <span class="math notranslate nohighlight">\(QR\)</span> or <span class="math notranslate nohighlight">\(LU\)</span>, because the factorization does not need to be recomputed for each system.</p>
</section>
<section id="qr-factorization-with-scipy">
<h2>QR factorization with SciPy<a class="headerlink" href="#qr-factorization-with-scipy" title="Link to this heading">#</a></h2>
<p>The SciPy function for finding <span class="math notranslate nohighlight">\(QR\)</span> factorizations is called <span class="math notranslate nohighlight">\(\texttt{qr}\)</span>.  The basic use is exactly the same as our <span class="math notranslate nohighlight">\(\texttt{QRfactorization}\)</span> function.  We apply <span class="math notranslate nohighlight">\(\texttt{qr}\)</span> to the matrix in the example and compare the results with our own computations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">scipy.linalg</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sla</span>

<span class="n">Qs</span><span class="p">,</span><span class="n">Rs</span> <span class="o">=</span> <span class="n">sla</span><span class="o">.</span><span class="n">qr</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;laguid Q</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SciPy Q</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">Qs</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;laguide R</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SciPy R</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">Rs</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span><span class="w"> </span><span class="nn">scipy.linalg</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sla</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">Qs</span><span class="p">,</span><span class="n">Rs</span> <span class="o">=</span> <span class="n">sla</span><span class="o">.</span><span class="n">qr</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;laguid Q</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;scipy&#39;
</pre></div>
</div>
</div>
</div>
<p>Although the results are displayed are close, we note that the entries of the SciPy are the negative of those we produced.  The SciPy function does not actually use the Gram Schmidt process, but instead approaches the factorization from an entirely different direction.</p>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<p><strong>Exercise 1:</strong></p>
<p>(<span class="math notranslate nohighlight">\(a\)</span>) Carry out the Gram-Schmidt algorithm on the following set of vectors to produce an orthonormal set <span class="math notranslate nohighlight">\(\{U_1, U_2, U_3\}\)</span>.  <strong>Do not</strong> use the <span class="math notranslate nohighlight">\(\texttt{QRFactorization}\)</span> function from this section or the SciPy <span class="math notranslate nohighlight">\(\texttt{qr}\)</span> function.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
V_1 = \left[ \begin{array}{r} 0 \\ 2 \\ 0 \\ 1 \end{array}\right] \hspace{0.7cm} 
V_2 = \left[ \begin{array}{r} 1 \\ 1 \\ 1 \\ 1 \end{array}\right] \hspace{0.7cm}
V_3 = \left[ \begin{array}{r} 2 \\ 2 \\ 0 \\ 1 \end{array}\right] \hspace{0.7cm}
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here.</span>
</pre></div>
</div>
</div>
</div>
<p>(<span class="math notranslate nohighlight">\(b\)</span>) Check your results by verifying that <span class="math notranslate nohighlight">\(\{U_1, U_2, U_3\}\)</span> is an orthonormal set and that the span of <span class="math notranslate nohighlight">\(\{U_1, U_2, U_3\}\)</span> equals the span of <span class="math notranslate nohighlight">\(\{V_1, V_2, V_3\}\)</span>.  (Reread <a class="reference internal" href="Linear_Combinations.html"><span class="std std-doc">Linear_Combinations</span></a> if you are unsure how to verify the two spans are equal.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here.</span>
</pre></div>
</div>
</div>
</div>
<p>(<span class="math notranslate nohighlight">\(c\)</span>) Check your results against those obtained using the <span class="math notranslate nohighlight">\(\texttt{QRFactorization}\)</span> function from this section or the <span class="math notranslate nohighlight">\(\texttt{qr}\)</span> function from SciPy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here.</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 2:</strong></p>
<p>(<span class="math notranslate nohighlight">\(a\)</span>) Predict what will happen if we attempt to find the QR factorization of matrix with <em>linearly dependent</em> columns.</p>
<p>(<span class="math notranslate nohighlight">\(b\)</span>) Try to compute the QR factorization on the following matrix with <em>linearly dependent</em> columns.  Try both the <span class="math notranslate nohighlight">\(\texttt{QRFactorization}\)</span> function from this section or the <span class="math notranslate nohighlight">\(\texttt{qr}\)</span> function from SciPy.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
B = \left[ \begin{array}{rrr} 
1 &amp; 3 &amp; -1  \\ 
0 &amp; -1 &amp; 1  \\ 
2 &amp; 2 &amp; 2  \\
1 &amp; 1 &amp; 1  \\
1 &amp; 0 &amp; 2  \\
\end{array}\right]
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here.</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 3:</strong> If possible, find the <span class="math notranslate nohighlight">\(QR\)</span> factorization of the matrix <span class="math notranslate nohighlight">\(A\)</span>. Try to find the matrices <span class="math notranslate nohighlight">\(Q\)</span> and <span class="math notranslate nohighlight">\(R\)</span> without using the <span class="math notranslate nohighlight">\(\texttt{QRFactorization}\)</span> function from this section, then check your result by verifying that <span class="math notranslate nohighlight">\(QR=A\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
A = \left[ \begin{array}{rrr} 
1 &amp; 3 &amp; 0 &amp; 2  \\ 
0 &amp; 1 &amp; 2 &amp; 1 \\ 
2 &amp; 1 &amp; 2 &amp; 1 \\
1 &amp; 0 &amp; 1 &amp; 3 \\
\end{array}\right]
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 4:</strong> Are all matrices which have <span class="math notranslate nohighlight">\(QR\)</span> factorization invertible? Explain.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 5:</strong> Use the <span class="math notranslate nohighlight">\(QR\)</span> factorization of <span class="math notranslate nohighlight">\(A\)</span> to solve the given linear system <span class="math notranslate nohighlight">\(AX = B\)</span>, and verify the solution.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
AX = \left[ \begin{array}{rrrr} 
1 &amp; 2 &amp; 3  \\ 
0 &amp; 3 &amp; 2  \\ 
1 &amp; 1 &amp; 4  \\
\end{array}\right]
\quad\quad
X = 
\left[ \begin{array}{r} 1 \\ 1 \\ 1 \\  \end{array} \right]
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 6:</strong> <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> are two <span class="math notranslate nohighlight">\(n \times n\)</span> matrices.</p>
<p>(<span class="math notranslate nohighlight">\(a\)</span>) Given that the product <span class="math notranslate nohighlight">\(BA\)</span> has <span class="math notranslate nohighlight">\(QR\)</span> factorization, prove that the matrix <span class="math notranslate nohighlight">\(A\)</span> also has a <span class="math notranslate nohighlight">\(QR\)</span> factorization.</p>
<p>(<span class="math notranslate nohighlight">\(b\)</span>) Can you think of matrices <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> such that <span class="math notranslate nohighlight">\(B\)</span> has linearly dependent columns  but the product <span class="math notranslate nohighlight">\(BA\)</span> has <span class="math notranslate nohighlight">\(QR\)</span> factorization? Explain.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 7:</strong> If <span class="math notranslate nohighlight">\(A\)</span> is an <span class="math notranslate nohighlight">\(n \times n\)</span> invertible matrix, explain why <span class="math notranslate nohighlight">\(A^TA\)</span> is also invertible.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "executablebooks/jupyter-book",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Orthogonalization.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Orthogonalization</p>
      </div>
    </a>
    <a class="right-next"
       href="Orthogonal_Subspaces.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Orthogonal Subspaces</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#structure-of-orthogonalization">Structure of orthogonalization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-finding-a-qr-factorization">Example 1:  Finding a QR factorization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#qr-factorization-function">QR factorization function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-solving-a-linear-system">Example 2:  Solving a linear system</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#qr-factorization-with-scipy">QR factorization with SciPy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Aditya Chaturvedi
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>