
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Inverse Matrices &#8212; Jupyter Guide to Linear Algebra</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Inverse_Matrices';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="LU Factorization" href="LU_Factorization.html" />
    <link rel="prev" title="Solving Systems using Elimination" href="Solving_Systems.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/reflection_logo.png" class="logo__image only-light" alt="Jupyter Guide to Linear Algebra - Home"/>
    <script>document.write(`<img src="_static/reflection_logo.png" class="logo__image only-dark" alt="Jupyter Guide to Linear Algebra - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to the Jupyter Guide to Linear Algebra
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="Jupyter_Introduction.html">Introduction to Jupyter</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Python_Introduction.html">Introduction to Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="Numpy_Introduction.html">Introduction to NumPy and Matplotlib</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="Linear_Systems.html">Linear Systems</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Gaussian_Elimination.html">Gaussian Elimination</a></li>
<li class="toctree-l2"><a class="reference internal" href="Matrix_Algebra.html">Matrix Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="Solving_Systems.html">Solving Systems using Elimination</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Inverse Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="LU_Factorization.html">LU Factorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="Applications.html">Applications of Linear Systems and Matrix Algebra</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Vector_Spaces.html">Vector Spaces</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="General_Linear_Systems.html">General Linear Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="Linear_Combinations.html">Linear Combinations</a></li>
<li class="toctree-l2"><a class="reference internal" href="Linear_Independence.html">Linear Independence</a></li>
<li class="toctree-l2"><a class="reference internal" href="Bases.html">Bases</a></li>
<li class="toctree-l2"><a class="reference internal" href="Vector_Space_Examples.html">Vector Space Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="Applications_VS.html">Applications of Vector Spaces</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Linear_Transformations.html">Linear Transformations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Matrix_Representations.html">Matrix Representations</a></li>
<li class="toctree-l2"><a class="reference internal" href="Planar_Transformations.html">Transformations in a Plane</a></li>
<li class="toctree-l2"><a class="reference internal" href="Applications_LT.html">Applications of Linear Transformations</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Inner_Products.html">Inner Products</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Orthogonalization.html">Orthogonalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="QR_Factorization.html">QR Factorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="Orthogonal_Subspaces.html">Orthogonal Subspaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="Least_Squares_Solutions.html">Least Squares Solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Projections.html">Projections</a></li>
<li class="toctree-l2"><a class="reference internal" href="Applications_IP.html">Applications of Inner Products</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Eigenvalues.html">Eigenvalues</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Diagonalization.html">Diagonalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="Approximating_Eigenvalues.html">Approximating Eigenvalues</a></li>
<li class="toctree-l2"><a class="reference internal" href="Applications_EV.html">Applications of Eigenvalues and Eigenvectors</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Solutions.html">Solutions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Introduction_Solutions.html">Introduction to Jupyter</a></li>
<li class="toctree-l2"><a class="reference internal" href="Linear_Systems_Solutions.html">Linear Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="Vector_Spaces_Solutions.html">Vector Spaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="Linear_Transformations_Solutions.html">Linear Transformations</a></li>
<li class="toctree-l2"><a class="reference internal" href="Inner_Products_Solutions.html">Inner Products</a></li>
<li class="toctree-l2"><a class="reference internal" href="Eigenvalues_Solutions.html">Eigenvalues</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Inverse_Matrices.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Inverse Matrices</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#construction-of-an-inverse-matrix">Construction of an inverse matrix</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#one-sided-inverses">One-sided inverses</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inverse-matrices-with-scipy">Inverse matrices with SciPy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="inverse-matrices">
<h1>Inverse Matrices<a class="headerlink" href="#inverse-matrices" title="Link to this heading">#</a></h1>
<p>In this section we consider the idea of inverse matrices and describe a common method for their construction.</p>
<p>As a motivation for the idea, let’s again consider the system of linear equations written in the matrix form.</p>
<div class="math notranslate nohighlight">
\[
AX = B
\]</div>
<p>Again, <span class="math notranslate nohighlight">\(A\)</span> is a matrix of coefficients that are known, <span class="math notranslate nohighlight">\(B\)</span> is a vector of known data, and <span class="math notranslate nohighlight">\(X\)</span> is a vector that is unknown.  If <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span>, and <span class="math notranslate nohighlight">\(X\)</span> were instead only numbers, we would recognize immediately that the way to solve for <span class="math notranslate nohighlight">\(X\)</span> is to divide both sides of the equation by <span class="math notranslate nohighlight">\(A\)</span>, so long as <span class="math notranslate nohighlight">\(A\neq 0\)</span>.  The natural question to ask about the system is <em>Can we define matrix division?</em></p>
<p>The answer is <em>Not quite.</em>  We can make progress though by understanding that in the case that <span class="math notranslate nohighlight">\(A\)</span>,<span class="math notranslate nohighlight">\(B\)</span>, and <span class="math notranslate nohighlight">\(X\)</span> are numbers, we could also find the solution by multiplying by <span class="math notranslate nohighlight">\(1/A\)</span>.  This subtle distinction is important because it means that we do not need to define division.  We only need to find the number, that when multiplied by <span class="math notranslate nohighlight">\(A\)</span> gives 1.  This number is called the multiplicative inverse of <span class="math notranslate nohighlight">\(A\)</span> and is written as <span class="math notranslate nohighlight">\(1/A\)</span>, so long as <span class="math notranslate nohighlight">\(A\neq 0\)</span>.</p>
<p>We can extend this idea to the situation where <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span>, and <span class="math notranslate nohighlight">\(X\)</span> are matrices.  In order to solve the system <span class="math notranslate nohighlight">\(AX=B\)</span>, we want to multiply by a certain matrix, that when multiplied by <span class="math notranslate nohighlight">\(A\)</span> will give the identity matrix <span class="math notranslate nohighlight">\(I\)</span>.  This matrix is known as the <strong>inverse matrix</strong>, and is given the symbol <span class="math notranslate nohighlight">\(A^{-1}\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(A\)</span> is a square matrix we define <span class="math notranslate nohighlight">\(A^{-1}\)</span> (read as “A inverse”) to be the matrix such that the following are true.</p>
<div class="math notranslate nohighlight">
\[
A^{-1}A = I \hspace{3cm}AA^{-1} = I
\]</div>
<p>Notes about inverse matrices:</p>
<ol class="arabic simple">
<li><p>The matrix must be square in order for this definition to make sense.  If <span class="math notranslate nohighlight">\(A\)</span> is not square, it is impossible for both
<span class="math notranslate nohighlight">\(A^{-1}A\)</span> and <span class="math notranslate nohighlight">\(AA^{-1}\)</span> to be defined.</p></li>
<li><p>Not all matrices have inverses.  Matrices that do have inverses are called <strong>invertible</strong> matrices.  Matrices that do not have inverses are called <strong>non-invertible</strong>, or <strong>singular</strong>, matrices.</p></li>
<li><p>If a matrix is invertible, its inverse is unique.</p></li>
</ol>
<p>Now <em>if we know</em> <span class="math notranslate nohighlight">\(A^{-1}\)</span>, we can solve the system <span class="math notranslate nohighlight">\(AX=B\)</span> by multiplying both sides by <span class="math notranslate nohighlight">\(A^{-1}\)</span>.</p>
<div class="math notranslate nohighlight">
\[
A^{-1}AX = A^{-1}B
\]</div>
<p>Then <span class="math notranslate nohighlight">\(A^{-1}AX = IX = X\)</span>, so the solution to the system is <span class="math notranslate nohighlight">\(X=A^{-1}B\)</span>.  Unfortunately, it is typically not easy to find <span class="math notranslate nohighlight">\(A^{-1}\)</span>.</p>
<section id="construction-of-an-inverse-matrix">
<h2>Construction of an inverse matrix<a class="headerlink" href="#construction-of-an-inverse-matrix" title="Link to this heading">#</a></h2>
<p>We take <span class="math notranslate nohighlight">\(C\)</span> as an example matrix, and consider how we might build the inverse.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
C = \left[ \begin{array}{rrrr} 1 &amp; 0 &amp; 2 &amp; -1 \\ 3 &amp; 1 &amp; -3 &amp; 2 \\ 2 &amp; 0 &amp; 4 &amp; 4 \\ 2 &amp; 1 &amp; -1 &amp; -1 \end{array}\right]
\end{split}\]</div>
<p>Let’s think of the matrix product <span class="math notranslate nohighlight">\(CC^{-1}= I\)</span> in terms of the columns of <span class="math notranslate nohighlight">\(C^{-1}\)</span>.  We put focus on the third column as an example, and label those unknown entries with <span class="math notranslate nohighlight">\(y_i\)</span>.  The * entries are uknown as well, but we will ignore them for the moment.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
CC^{-1}=
\left[ \begin{array}{rrrr} 1 &amp; 0 &amp; 2 &amp; -1 \\ 3 &amp; 1 &amp; -3 &amp; 2 \\ 2 &amp; 0 &amp; 4 &amp; 4 \\ 2 &amp; 1 &amp; -1 &amp; -1 \end{array}\right]
\left[ \begin{array}{rrrr} * &amp; * &amp; y_1&amp; * \\ * &amp; * &amp; y_2 &amp; * \\ * &amp; * &amp; y_3 &amp; * \\ * &amp; * &amp; y_4 &amp; *  \end{array}\right]=
\left[ \begin{array}{rrrr} 1 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 1 \end{array}\right]=
I
\end{split}\]</div>
<p>Recall now that <span class="math notranslate nohighlight">\(C\)</span> multiplied by the third column of <span class="math notranslate nohighlight">\(C^{-1}\)</span> produces the third column of <span class="math notranslate nohighlight">\(I\)</span>.  This gives us a linear system to solve for the <span class="math notranslate nohighlight">\(y_i\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\left[ \begin{array}{rrrr} 1 &amp; 0 &amp; 2 &amp; -1 \\ 3 &amp; 1 &amp; -3 &amp; 2 \\ 2 &amp; 0 &amp; 4 &amp; 4 \\ 2 &amp; 1 &amp; -1 &amp; -1 \end{array}\right]
\left[ \begin{array}{r}  y_1 \\  y_2  \\ y_3 \\ y_4  \end{array}\right]=
\left[ \begin{array}{r}  0 \\  0  \\ 1 \\ 0  \end{array}\right]
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">laguide</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">lag</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Solve CY = I3</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">I3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">Y3</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">SolveSystem</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">I3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-0.16666667]
 [ 0.66666667]
 [ 0.16666667]
 [ 0.16666667]]
</pre></div>
</div>
</div>
</div>
<p>The other columns of <span class="math notranslate nohighlight">\(C^{-1}\)</span> can be found by solving similar systems with the corresponding columns of the identity matrix.  We can then build <span class="math notranslate nohighlight">\(C^{-1}\)</span> by assembling the columns into a single matrix, and test the result by checking the products <span class="math notranslate nohighlight">\(C^{-1}C\)</span> and <span class="math notranslate nohighlight">\(CC^{-1}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">I1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">I2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">I4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">Y1</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">SolveSystem</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">I1</span><span class="p">)</span>
<span class="n">Y2</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">SolveSystem</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">I2</span><span class="p">)</span>
<span class="n">Y4</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">SolveSystem</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">I4</span><span class="p">)</span>

<span class="n">C_inverse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">Y1</span><span class="p">,</span><span class="n">Y2</span><span class="p">,</span><span class="n">Y3</span><span class="p">,</span><span class="n">Y4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;C inverse:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">C_inverse</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;C inverse times C:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">C_inverse</span><span class="nd">@C</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;C times C inverse:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">C</span><span class="nd">@C_inverse</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C inverse:
[[ 0.83333333  0.5        -0.16666667 -0.5       ]
 [-2.08333333 -1.25        0.66666667  2.25      ]
 [-0.08333333 -0.25        0.16666667  0.25      ]
 [-0.33333333  0.          0.16666667  0.        ]]

C inverse times C:
[[ 1.00000000e+00  0.00000000e+00 -1.11022302e-16  1.11022302e-16]
 [ 0.00000000e+00  1.00000000e+00  0.00000000e+00  4.44089210e-16]
 [ 5.55111512e-17  0.00000000e+00  1.00000000e+00 -5.55111512e-17]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  1.00000000e+00]]

C times C inverse:
[[ 1.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [-1.11022302e-16  1.00000000e+00  5.55111512e-17  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  1.00000000e+00  0.00000000e+00]
 [-3.33066907e-16  0.00000000e+00  1.11022302e-16  1.00000000e+00]]
</pre></div>
</div>
</div>
</div>
<p>Similar to the situation in the previous section, some of the entries that should be zero are not exactly zero due to roundoff error.  Again, we can display a rounded version to read the results more easily.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">C</span><span class="nd">@C_inverse</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 1.  0.  0.  0.]
 [-0.  1.  0.  0.]
 [ 0.  0.  1.  0.]
 [-0.  0.  0.  1.]]
</pre></div>
</div>
</div>
</div>
<p>We will next write a Python function to compute the inverse of a matrix.  In practice finding the inverse of a matrix is a terribly inefficient way of solving a linear system.  We have to solve <span class="math notranslate nohighlight">\(n\)</span> systems to just to find the inverse of an <span class="math notranslate nohighlight">\(n \times n\)</span> matrix, so it appears that it takes <span class="math notranslate nohighlight">\(n\)</span> times the amount of work that it would to just solve the system by elimination.  Suppose however that we needed to solve a linear system <span class="math notranslate nohighlight">\(AX=B\)</span> for <em>many different vectors</em> <span class="math notranslate nohighlight">\(B\)</span>, but the same coefficient matrix <span class="math notranslate nohighlight">\(A\)</span>.  In that case it might seem appealing to construct <span class="math notranslate nohighlight">\(A^{-1}\)</span>.</p>
<p>In order to keep the computation somewhat efficient, we want to avoid repeating the row operations as much as possible.  In order to construct <span class="math notranslate nohighlight">\(A^{-1}\)</span> we need to solve the system <span class="math notranslate nohighlight">\(AX_i=Y_i\)</span>, where <span class="math notranslate nohighlight">\(Y_i\)</span> is the <span class="math notranslate nohighlight">\(i\)</span>th column of <span class="math notranslate nohighlight">\(I\)</span>.  This will produce <span class="math notranslate nohighlight">\(X\)</span>, which is the <span class="math notranslate nohighlight">\(i\)</span>th column of <span class="math notranslate nohighlight">\(A^{-1}\)</span>.  Instead of performing elimination on each augmented matrix <span class="math notranslate nohighlight">\([A|Y_i]\)</span>, we can augment <span class="math notranslate nohighlight">\(A\)</span> with the entire matrix <span class="math notranslate nohighlight">\(I\)</span> and perform the required operations on all <span class="math notranslate nohighlight">\(Y_i\)</span> at the same time.  For example, if <span class="math notranslate nohighlight">\(A\)</span> is a <span class="math notranslate nohighlight">\(4\times 4\)</span> matrix, we will have the following augmented matrix.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
[A|I] = \left[ \begin{array}{rrrr|rrrr} 
* &amp; * &amp; * &amp; * &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\ 
* &amp; * &amp; * &amp; * &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
* &amp; * &amp; * &amp; * &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
* &amp; * &amp; * &amp; * &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\ 
\end{array}\right]
\end{equation}
\end{split}\]</div>
<p>If <span class="math notranslate nohighlight">\(A\)</span> is invertible, the <span class="math notranslate nohighlight">\(\texttt{RowReduction}\)</span> routine from the previous section should return a matrix of the following form.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
[A|I] = \left[ \begin{array}{rrrr|rrrr} 
* &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * \\ 
0 &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * \\
0 &amp; 0 &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * \\
0 &amp; 0 &amp; 0 &amp; * &amp; * &amp; * &amp; * &amp; * \\ 
\end{array}\right]
\end{equation}
\end{split}\]</div>
<p>We can then call the <span class="math notranslate nohighlight">\(\texttt{BackSubstitution}\)</span> function once for each column in the right half of this matrix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">Inverse</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="c1"># =============================================================================</span>
    <span class="c1"># A is a NumPy array that represents a matrix of dimension n x n.</span>
    <span class="c1"># Inverse computes the inverse matrix by solving AX=I where I is the identity.</span>
    <span class="c1"># If A is not invertible, Inverse will not return correct results.</span>
    <span class="c1"># =============================================================================</span>

    <span class="c1"># Check shape of A</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Inverse accepts only square arrays.&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># n is number of rows and columns in A</span>

    <span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    
    <span class="c1"># The augmented matrix is A together with all the columns of I.  RowReduction is</span>
    <span class="c1"># carried out simultaneously for all n systems.</span>
    <span class="n">A_augmented</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">A</span><span class="p">,</span><span class="n">I</span><span class="p">))</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">RowReduction</span><span class="p">(</span><span class="n">A_augmented</span><span class="p">)</span>
    
    <span class="n">Inverse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
    
    <span class="c1"># Now BackSubstitution is carried out for each column and the result is stored </span>
    <span class="c1"># in the corresponding column of Inverse.</span>
    <span class="n">A_reduced</span> <span class="o">=</span> <span class="n">R</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
        <span class="n">B_reduced</span> <span class="o">=</span> <span class="n">R</span><span class="p">[:,</span><span class="n">n</span><span class="o">+</span><span class="n">i</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Inverse</span><span class="p">[:,</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">BackSubstitution</span><span class="p">(</span><span class="n">A_reduced</span><span class="p">,</span><span class="n">B_reduced</span><span class="p">)</span>
    
    <span class="k">return</span><span class="p">(</span><span class="n">Inverse</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">Inverse</span><span class="p">(</span><span class="n">C</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 0.83333333  0.5        -0.16666667 -0.5       ]
 [-2.08333333 -1.25        0.66666667  2.25      ]
 [-0.08333333 -0.25        0.16666667  0.25      ]
 [-0.33333333  0.          0.16666667  0.        ]]
</pre></div>
</div>
</div>
</div>
<p>If a matrix is non-invertible then the process above fails.  We have to realize that within the <span class="math notranslate nohighlight">\(\texttt{BackSubstitution}\)</span> routine we divide by the entries along the main diagonal of the upper triangular matrix.  Recall that these entries are in the very important pivot positions. If there is a zero in at least one pivot position, then the original matrix is non-invertible.</p>
<p>Suppose for example that after performing  <span class="math notranslate nohighlight">\(\texttt{RowReduction}\)</span> on the augmented matrix <span class="math notranslate nohighlight">\([A|I]\)</span> in the <span class="math notranslate nohighlight">\(\texttt{Inverse}\)</span> routine, the result is as follows.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
[A|I] = \left[ \begin{array}{rrrr|rrrr} 
* &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * \\ 
0 &amp; 0 &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * \\
0 &amp; 0 &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * \\
0 &amp; 0 &amp; 0 &amp; * &amp; * &amp; * &amp; * &amp; * \\ 
\end{array}\right]
\end{equation}
\end{split}\]</div>
<p>In this case <span class="math notranslate nohighlight">\( \texttt {BackSubstitution}\)</span> will fail due to the zero in the pivot position of the second row. Hence, <span class="math notranslate nohighlight">\(A^{-1}\)</span> does not exist and we can conclude that <span class="math notranslate nohighlight">\(A\)</span> is non-invertible.</p>
<p>In general we determine if a given matrix is invertible by carrying out the steps of elimination and examining the entries on the main diagonal of the corresponding upper triangular matrix.  The original matrix is invertible if and only if all of those entries are nonzoro.</p>
</section>
<section id="one-sided-inverses">
<h2>One-sided inverses<a class="headerlink" href="#one-sided-inverses" title="Link to this heading">#</a></h2>
<p>When a matrix is not square it cannot be considered invertible by the definition above.  It can be useful however to consider one-sided inverses.  If <span class="math notranslate nohighlight">\(A\)</span> is an <span class="math notranslate nohighlight">\(m\times n\)</span> matrix, we say that a matrix <span class="math notranslate nohighlight">\(F\)</span> is a <strong>right inverse</strong> of <span class="math notranslate nohighlight">\(A\)</span> if <span class="math notranslate nohighlight">\(AF=I_m\)</span>.  Similarly, we say that a matrix <span class="math notranslate nohighlight">\(G\)</span> is a <strong>left inverse</strong> of <span class="math notranslate nohighlight">\(A\)</span> if <span class="math notranslate nohighlight">\(GA=I_n\)</span>.  Note here that both the right inverse <span class="math notranslate nohighlight">\(F\)</span> and the left inverse <span class="math notranslate nohighlight">\(G\)</span> are <span class="math notranslate nohighlight">\(n\times m\)</span> matrices, <span class="math notranslate nohighlight">\(I_m\)</span> is the <span class="math notranslate nohighlight">\(m\times m\)</span> identity matrix, and <span class="math notranslate nohighlight">\(I_n\)</span> is the <span class="math notranslate nohighlight">\(n\times n\)</span> identity matrix.</p>
<p>It is interesting to note that if a matrix <span class="math notranslate nohighlight">\(A\)</span> has <em>both</em> a right inverse <span class="math notranslate nohighlight">\(F\)</span> and a left inverse <span class="math notranslate nohighlight">\(G\)</span> then they must be equal since</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
F = I_nF = (GA)F = G(AF) = GI_m = G.
\end{equation}
\]</div>
<p>This means that unless <span class="math notranslate nohighlight">\(A\)</span> is square  (with <span class="math notranslate nohighlight">\(m=n\)</span>) it cannot have both a left inverse and a right inverse.</p>
<p>The one-sided inverses are also related to the solution of the linear system <span class="math notranslate nohighlight">\(AX=B\)</span>.  If <span class="math notranslate nohighlight">\(A\)</span> has a right inverse <span class="math notranslate nohighlight">\(F\)</span> then the system must have <em>at least</em> one solution, <span class="math notranslate nohighlight">\(X = FB\)</span>.</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
AX = A(FB) = (AF)B = IB = B
\end{equation}
\]</div>
<p>We shall see later that the system <span class="math notranslate nohighlight">\(AX=B\)</span> has <em>at most</em> one solution when <span class="math notranslate nohighlight">\(A\)</span> has a left inverse.</p>
</section>
<section id="inverse-matrices-with-scipy">
<h2>Inverse matrices with SciPy<a class="headerlink" href="#inverse-matrices-with-scipy" title="Link to this heading">#</a></h2>
<p>The <span class="math notranslate nohighlight">\(\texttt{inv}\)</span> function is used to compute inverse matrices in the SciPy <span class="math notranslate nohighlight">\(\texttt{linalg}\)</span> module.  Once the module is imported, the usage of <span class="math notranslate nohighlight">\(\texttt{inv}\)</span> is exactly the same as the function we just created.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">scipy.linalg</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sla</span>

<span class="n">C_inverse</span> <span class="o">=</span> <span class="n">sla</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">C_inverse</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span><span class="w"> </span><span class="nn">scipy.linalg</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sla</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">C_inverse</span> <span class="o">=</span> <span class="n">sla</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="nb">print</span><span class="p">(</span><span class="n">C_inverse</span><span class="p">)</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;scipy&#39;
</pre></div>
</div>
</div>
</div>
<p>Providing a non-invertible matrix to <span class="math notranslate nohighlight">\(\texttt{inv}\)</span> will result in an error being raised by the Python interpreter.</p>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<p><strong>Exercise 1:</strong> Solve the following system of equations using an inverse matrix.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
2x_1 + 3x_2 + x_3 &amp; = &amp; 4\\
3x_1 + 3x_2 + x_3 &amp; = &amp; 8\\
2x_1 + 4x_2 + x_3 &amp; = &amp; 5 
\end{eqnarray*}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 2:</strong> Let <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> be two random <span class="math notranslate nohighlight">\(4\times 4\)</span> matrices.  Demonstrate using Python that <span class="math notranslate nohighlight">\((AB)^{-1}=B^{-1}A^{-1}\)</span> for the matrices.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 3:</strong> Explain why <span class="math notranslate nohighlight">\((AB)^{-1}=B^{-1}A^{-1}\)</span> by using the definition given in this section.</p>
<p><strong>Exercise 4:</strong>  Solve the system <span class="math notranslate nohighlight">\(AX=B\)</span> by finding <span class="math notranslate nohighlight">\(A^{-1}\)</span> and computing <span class="math notranslate nohighlight">\(X=A^{-1}B\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A = \left[ \begin{array}{rrrr} 1 &amp; 2 &amp; -3 \\ -1 &amp; 1 &amp; -1  \\ 0 &amp; -2 &amp; 3  \end{array}\right] \quad\quad
B = \left[ \begin{array}{rrrr} 1  \\ 1 \\ 1  \end{array}\right]
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 5:</strong> Find a <span class="math notranslate nohighlight">\(3 \times 3 \)</span> matrix <span class="math notranslate nohighlight">\(Y\)</span> such that <span class="math notranslate nohighlight">\(AY = C\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A = \left[ \begin{array}{rrrr} 3 &amp; 1 &amp; 0 \\ 5 &amp; 2 &amp; 1 \\ 0 &amp; 2 &amp; 3\end{array}\right]\hspace{2cm}
C = \left[ \begin{array}{rrrr} 1 &amp; 2 &amp; 1 \\ 3 &amp; 4 &amp; 0 \\ 1 &amp; 0 &amp; 2 \end{array}\right]\hspace{2cm}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 6:</strong> Let <span class="math notranslate nohighlight">\(A\)</span> be a random <span class="math notranslate nohighlight">\(4 \times 1\)</span> matrix and <span class="math notranslate nohighlight">\(B\)</span> is a random <span class="math notranslate nohighlight">\( 1 \times 4 \)</span> matrix. Use Python to demonstrate that the product <span class="math notranslate nohighlight">\( AB \)</span> is not invertible. Do you expect this to be true for any two matrices <span class="math notranslate nohighlight">\(P\)</span> and <span class="math notranslate nohighlight">\(Q\)</span> such that <span class="math notranslate nohighlight">\(P\)</span> is an <span class="math notranslate nohighlight">\( n \times 1 \)</span> matrix and <span class="math notranslate nohighlight">\(Q\)</span> is a <span class="math notranslate nohighlight">\( 1 \times n\)</span> matrix ? Explain.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 7:</strong> Let <span class="math notranslate nohighlight">\(A\)</span> be a random <span class="math notranslate nohighlight">\( 3 \times 3\)</span> matrices. Demonstrate using Python that <span class="math notranslate nohighlight">\((A^T)^{-1} = (A^{-1})^T\)</span> for the matrix. Use this property to explain why <span class="math notranslate nohighlight">\(A^{-1}\)</span> must be symmetric if <span class="math notranslate nohighlight">\(A\)</span> is symmetric.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 8:</strong> Consider the following <span class="math notranslate nohighlight">\( 4 \times 4 \)</span> matrix:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A = \left[ \begin{array}{rrrr} 4 &amp; x_1 &amp; 0 &amp; 0 \\ 0 &amp; x_2 &amp; 0 &amp; 0 \\ 0 &amp; x_3 &amp; 1 &amp; 0 \\ 0 &amp; x_4 &amp; 0 &amp; 3 \end{array}\right]
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\((a)\)</span> Find the condition on <span class="math notranslate nohighlight">\(x_1\)</span>, <span class="math notranslate nohighlight">\(x_2\)</span>, <span class="math notranslate nohighlight">\(x_3\)</span> or <span class="math notranslate nohighlight">\(x_4\)</span> for which <span class="math notranslate nohighlight">\(A^{-1}\)</span> exists. Assuming that condition is true, find the inverse of <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p><span class="math notranslate nohighlight">\((b)\)</span> Use Python to check if <span class="math notranslate nohighlight">\( A^{-1}A = I \)</span> when <span class="math notranslate nohighlight">\(x_1 = 4\)</span>, <span class="math notranslate nohighlight">\(x_2 = 1\)</span>, <span class="math notranslate nohighlight">\(x_3 = 1\)</span>, and <span class="math notranslate nohighlight">\(x_4 = 3\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 9:</strong> Apply the methods used in this section to compute a right inverse of the matrix <span class="math notranslate nohighlight">\(A\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A = \left[ \begin{array}{rrrr} 1 &amp; 0 &amp; 0 &amp; 2 \\ 0 &amp; -1 &amp; 1 &amp; 4 \end{array}\right]
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "executablebooks/jupyter-book",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Solving_Systems.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Solving Systems using Elimination</p>
      </div>
    </a>
    <a class="right-next"
       href="LU_Factorization.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">LU Factorization</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#construction-of-an-inverse-matrix">Construction of an inverse matrix</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#one-sided-inverses">One-sided inverses</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inverse-matrices-with-scipy">Inverse matrices with SciPy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Aditya Chaturvedi
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>